<section id="portfolio" class="py-24 bg-[#051129] dark:bg-[#0b132a] overflow-hidden">
  <div class="container mx-auto px-6">

    <div class="mb-20">
      <div class="flex items-center gap-3 mb-4">
        <span class="w-12 h-[2px] bg-[#007bff]"></span>
        <span class="text-[#007bff] font-bold uppercase tracking-[0.3em] text-xs">Our Works</span>
      </div>
      <h2 class="text-5xl md:text-7xl font-extrabold text-white tracking-tighter">
        Projets récents<span class="text-[#007bff]">.</span>
      </h2>
    </div>

    <app-rechercher (searchChanged)="query.set($event)"></app-rechercher>

    <div class="flex overflow-x-auto gap-12 pb-24 snap-x no-scrollbar items-start">
      @for (item of projetsFiltres(); track item.id) {
        <div class="min-w-[320px] md:min-w-[450px] snap-center group relative {{ item.classe }}">
          
          <div class="relative overflow-hidden rounded-[2.5rem] bg-gray-800 aspect-[4/5] shadow-2xl">
            <img [src]="item.image" [alt]="item.title"
                 class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" />

            @if (adminService.isAdmin()) {
              <div class="absolute top-6 right-6 flex gap-3 z-30">
                <button (click)="editProject(item)"
                  class="bg-white text-[#1A202C] p-4 rounded-full shadow-xl hover:bg-[#007bff] hover:text-white transition-all transform hover:scale-110">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                  </svg>
                </button>

                <button (click)="deleteProject(item.id)"
                  class="bg-white text-red-600 p-4 rounded-full shadow-xl hover:bg-red-600 hover:text-white transition-all transform hover:scale-110">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                  </svg>
                </button>
              </div>
            }
          </div>

          <a [routerLink]="['/projet', item.id]">
            <div class="mt-10 px-2">
              <h3 class="text-3xl font-bold text-white group-hover:text-[#007bff] transition-colors">{{ item.title }}</h3>
              <p class="text-gray-400 text-xl font-medium mt-2">{{ item.domaine }}</p>
            </div>
          </a>
        </div>
      } @empty {
        <div class="w-full text-center py-20">
          <p class="text-gray-500 text-2xl italic">Aucun projet ne correspond à votre recherche.</p>
        </div>
      }
    </div>
  </div>
</section>